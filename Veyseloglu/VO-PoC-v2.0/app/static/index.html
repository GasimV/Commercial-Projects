<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Reorder Prediction System</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600;700&family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script> -->
    <script src="js/chart.js"></script>
</head>
<body>
    <div class="grain-overlay"></div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                            <path d="M2 17l10 5 10-5"/>
                            <path d="M2 12l10 5 10-5"/>
                        </svg>
                    </div>
                    <span class="logo-text">REORDER<span class="logo-accent">.AI</span></span>
                </div>
                <div class="header-status" id="systemStatus">
                    <div class="status-dot"></div>
                    <span>System Ready</span>
                </div>
            </div>
        </div>
    </header>

    <div class="container main-container">

        <!-- Hero Section -->
        <section class="hero">
            <div class="hero-badge">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v6m0 6v6m5.66-13.66l-3.46 3.46m-2.4 2.4l-3.46 3.46m12.72-.72l-3.46-3.46m-2.4-2.4l-3.46-3.46"/>
                </svg>
                <span>Advanced ML Pipeline</span>
            </div>
            <h1 class="hero-title">
                Predict Customer <span class="gradient-text">Reorders</span>
                <br>with Deep Learning
            </h1>
            <p class="hero-description">
                State-of-the-art ensemble combining FFNN, LSTM, and LightGBM
                for accurate reorder likelihood and quantity forecasting
            </p>
        </section>

        <!-- Upload Section -->
        <section class="card card-primary">
            <div class="card-header">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="17 8 12 3 7 8"/>
                        <line x1="12" y1="3" x2="12" y2="15"/>
                    </svg>
                    Data Upload
                </h2>
                <span class="card-badge">Step 1</span>
            </div>
            <div class="card-body">
                <div class="upload-zone" id="uploadZone">
                    <input type="file" id="fileInput" accept=".csv,.parquet" hidden>
                    <div class="upload-content">
                        <div class="upload-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                                <line x1="12" y1="18" x2="12" y2="12"/>
                                <line x1="9" y1="15" x2="15" y2="15"/>
                            </svg>
                        </div>
                        <p class="upload-text">Drop CSV or Parquet file here or <span class="text-link">browse</span></p>
                        <p class="upload-hint">Sales data with order history required</p>
                    </div>
                </div>

                <div class="data-summary hidden" id="dataSummary">
                    <div class="summary-grid">
                        <div class="summary-card">
                            <div class="summary-label">Total Records</div>
                            <div class="summary-value" id="totalRecords">-</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-label">Customers</div>
                            <div class="summary-value" id="totalCustomers">-</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-label">Products</div>
                            <div class="summary-value" id="totalProducts">-</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-label">Date Range</div>
                            <div class="summary-value" id="dateRange">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Training Section -->
        <section class="card">
            <div class="card-header">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                    </svg>
                    Model Training
                </h2>
                <span class="card-badge">Step 2</span>
            </div>
            <div class="card-body">
                <div class="settings-grid">
                    <div class="form-group">
                        <label for="predictionHorizon">Prediction Horizon (days)</label>
                        <input type="number" id="predictionHorizon" value="14" min="1" max="60" class="input">
                        <span class="input-hint">Predict if customer will reorder within N days</span>
                    </div>
                    <div class="form-group" style="justify-content: center;">
                        <label class="checkbox-container">
                            <input type="checkbox" id="resumeTraining">
                            <span class="checkmark"></span>
                            Resume from saved features
                        </label>
                        <span class="input-hint">Skip feature engineering if possible</span>
                    </div>
                </div>

                <button id="trainBtn" class="btn btn-primary btn-large" disabled>
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <polygon points="5 3 19 12 5 21 5 3"/>
                    </svg>
                    Train All Models
                </button>

                <button id="viewMetricsBtn" class="btn btn-secondary" style="margin-left: 10px;">
                    View Current Metrics
                </button>

                <div class="training-progress hidden" id="trainingProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p class="progress-text" id="progressText">Initializing...</p>
                </div>

                <div class="metrics-display hidden" id="metricsDisplay">
                    <h3 class="section-title">Model Performance</h3>
                    <div class="metrics-grid">
                        <!-- Dynamically populated -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Prediction Section -->
        <section class="card">
            <div class="card-header">
                <h2>
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                        <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
                        <line x1="12" y1="22.08" x2="12" y2="12"/>
                    </svg>
                    Predictions
                </h2>
                <span class="card-badge">Step 3</span>
            </div>
            <div class="card-body">
                <div class="tabs">
                    <button class="tab active" data-tab="customer">By Customer</button>
                    <button class="tab" data-tab="product">By Product</button>
                    <button class="tab" data-tab="compare">Compare Models</button>
                    <button class="tab" data-tab="stock">Stock Forecast</button>
                </div>

                <!-- Customer Tab -->
                <div class="tab-content active" data-content="customer">
                    <div class="search-section">
                        <div class="search-box">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="m21 21-4.35-4.35"/>
                            </svg>
                            <input type="text" id="customerSearch" class="input" placeholder="Search customer ID...">
                        </div>
                        <select id="modelSelect" class="select">
                            <option value="ensemble">Ensemble (Recommended)</option>
                            <option value="lgbm">LightGBM</option>
                            <option value="ffnn">FFNN</option>
                        </select>
                        <div class="form-group" style="width: 100px;">
                            <input type="number" id="customerTopK" class="input" value="20" min="1" max="100">
                        </div>
                        <button id="predictCustomerBtn" class="btn btn-primary" disabled>
                            Predict
                        </button>

                    </div>

                    <div class="results-container hidden" id="customerResults">
                        <div class="results-header">
                            <h3>Top Reorder Candidates</h3>
                            <div class="results-count" id="resultsCount">0 products</div>
                        </div>
                        <div class="results-grid" id="resultsGrid">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                </div>

                <!-- Product Tab -->
                <div class="tab-content" data-content="product">
                    <div class="search-section">
                        <div class="search-box">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="m21 21-4.35-4.35"/>
                            </svg>
                            <input type="text" id="productSearch" class="input" placeholder="Search product ID...">
                        </div>
                        <select id="productModelSelect" class="select">
                            <option value="ensemble">Ensemble (Recommended)</option>
                            <option value="lgbm">LightGBM</option>
                            <option value="ffnn">FFNN</option>
                        </select>
                        <div class="form-group" style="width: 100px;">
                            <input type="number" id="productTopK" class="input" value="20" min="1" max="100">
                        </div>
                        <button id="predictProductBtn" class="btn btn-primary" disabled>
                            Predict
                        </button>
                    </div>

                    <div class="results-container hidden" id="productResults">
                        <div class="results-header">
                            <h3>Customers Likely to Reorder</h3>
                            <div class="results-count" id="productResultsCount">0 customers</div>
                        </div>
                        <div class="results-grid" id="productResultsGrid">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                </div>

                <!-- Stock Tab -->
                <div class="tab-content" data-content="stock">
                    <div class="search-section">
                        <div class="search-box">
                             <!-- This serves as your "By Fabric" search -->
                            <input type="text" id="fabricSearch" class="input" placeholder="Filter by Manufacturer/Fabric (Optional)...">
                        </div>
                        <button id="generateForecastBtn" class="btn btn-primary">
                            Generate Plan
                        </button>
                    </div>

                    <!-- Table for Stock Planner -->
                    <div class="results-container hidden" id="stockResults">
                        <table class="data-table" style="width:100%; text-align:left; border-collapse:collapse;">
                            <thead>
                                <tr style="border-bottom:1px solid #333; color:#888;">
                                    <th style="padding:10px;">Product</th>
                                    <th>Manufacturer</th>
                                    <th>Cust. Count</th>
                                    <th>Total Qty Needed</th>
                                </tr>
                            </thead>
                            <tbody id="stockTableBody">
                                <!-- Rows go here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Compare Tab -->
                <div class="tab-content" data-content="compare">
                    <div class="search-section">
                        <div class="search-box">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="m21 21-4.35-4.35"/>
                            </svg>
                            <input type="text" id="compareCustomerSearch" class="input" placeholder="Customer ID to compare...">
                        </div>
                        <button id="compareBtn" class="btn btn-primary" disabled>
                            Compare
                        </button>
                    </div>

                    <div class="comparison-container hidden" id="comparisonResults">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <footer class="footer">
        <div class="container">
            <p>Advanced Reorder Prediction System v2.0 | Powered by TensorFlow, LightGBM & scikit-learn</p>
        </div>
    </footer>

    <script src="js/app.js"></script>
    <style>
        /* Add checkbox styles here for simplicity or move to style.css */
        .checkbox-container {
            display: flex;
            align-items: center;
            position: relative;
            padding-left: 30px;
            cursor: pointer;
            font-size: 0.875rem;
            color: var(--color-text-secondary);
            font-weight: 600;
            user-select: none;
        }

        .checkbox-container input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 20px;
            width: 20px;
            background-color: var(--color-surface);
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }

        .checkbox-container:hover input ~ .checkmark {
            background-color: var(--color-surface-elevated);
        }

        .checkbox-container input:checked ~ .checkmark {
            background-color: var(--color-accent);
            border-color: var(--color-accent);
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .checkbox-container input:checked ~ .checkmark:after {
            display: block;
        }

        .checkbox-container .checkmark:after {
            left: 7px;
            top: 3px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }
    </style>
</body>
</html>